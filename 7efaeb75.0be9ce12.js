(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{109:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=i.a.createContext({}),p=function(e){var t=i.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return i.a.createElement(s.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},h=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,r=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=p(n),h=a,m=d["".concat(r,".").concat(h)]||d[h]||b[h]||c;return n?i.a.createElement(m,o(o({ref:t},s),{},{components:n})):i.a.createElement(m,o({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,r=new Array(c);r[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,r[1]=o;for(var s=2;s<c;s++)r[s]=n[s];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},82:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return p}));var a=n(3),i=n(7),c=(n(0),n(109)),r={id:"tutorials-scenes-updating-game1",title:"Updating Game1",hide_title:!1,hide_table_of_contents:!1,sidebar_label:"Updating Game1",custom_edit_url:null,keywords:["monogame tutorial","monogame framework","monogame","tutorial","scene transition","scene","scenes"],description:"A tutorial on create scene transition effects in a MonoGame project.",image:null,slug:"/tutorials/scenes/updating-game1"},o={unversionedId:"tutorials/scenes/tutorials-scenes-updating-game1",id:"tutorials/scenes/tutorials-scenes-updating-game1",isDocsHomePage:!1,title:"Updating Game1",description:"A tutorial on create scene transition effects in a MonoGame project.",source:"@site/docs\\tutorials\\scenes\\updating-game1.md",slug:"/tutorials/scenes/updating-game1",permalink:"/docs/tutorials/scenes/updating-game1",editUrl:null,version:"current",sidebar_label:"Updating Game1",sidebar:"tutorials",previous:{title:"The Scene Class",permalink:"/docs/tutorials/scenes/the-scene-class"},next:{title:"Testing Our Setup",permalink:"/docs/tutorials/scenes/testing-our-setup"}},l=[{value:"Tracking Active and Next Scene",id:"tracking-active-and-next-scene",children:[]},{value:"Updating the Active Scene",id:"updating-the-active-scene",children:[]},{value:"Drawing the Active Scene",id:"drawing-the-active-scene",children:[]},{value:"Changing Scenes",id:"changing-scenes",children:[]}],s={rightToc:l};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Now that we have the ",Object(c.b)("inlineCode",{parentName:"p"},"Scene")," class completed, we need to up ",Object(c.b)("inlineCode",{parentName:"p"},"Game1")," so it can properly handle scenes.  The following is a list of things that will need to be handled"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Keeping track of what scene is currently the active scene and which scene, if any, is the next scene."),Object(c.b)("li",{parentName:"ul"},"Updating the active scene."),Object(c.b)("li",{parentName:"ul"},"Drawing the active scene."),Object(c.b)("li",{parentName:"ul"},"Ability to change from one scene to another.")),Object(c.b)("p",null,"In the next sections, we'll go over implementing each of the points into our ",Object(c.b)("inlineCode",{parentName:"p"},"Game1")," class. So open up ",Object(c.b)("strong",{parentName:"p"},"Game1.cs")," and let's dive in."),Object(c.b)("h3",{id:"tracking-active-and-next-scene"},"Tracking Active and Next Scene"),Object(c.b)("p",null,"We can make use of two instance field to keep track of which scene is the ",Object(c.b)("strong",{parentName:"p"},"active")," scene and, when we need to change scenes, which is the ",Object(c.b)("strong",{parentName:"p"},"next")," scene to switch to."),Object(c.b)("p",null,"Add the following fields to ",Object(c.b)("inlineCode",{parentName:"p"},"Game1")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-csharp"}),"//  The current scene that is active.\nprivate Scene _activeScene;\n\n//  The next scene to switch to.\nprivate Scene _nextScene;\n")),Object(c.b)("h3",{id:"updating-the-active-scene"},"Updating the Active Scene"),Object(c.b)("p",null,"Next, we need to ensure that we are updating the active scene.  Find the ",Object(c.b)("inlineCode",{parentName:"p"},"Update(GameTime)")," method in Game1 and change it to the following"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-csharp"}),"protected override void Update(GameTime gameTime)\n{\n    //  If there is an active scene, update it.\n    if(_activeScene != null)\n    {\n        _activeScene.Update(gameTime);\n    }\n\n    base.Update(gameTime);\n}\n")),Object(c.b)("p",null,"And that's it for updating the active scene. Let's draw it next"),Object(c.b)("h3",{id:"drawing-the-active-scene"},"Drawing the Active Scene"),Object(c.b)("p",null,"To draw the active scene, find the ",Object(c.b)("inlineCode",{parentName:"p"},"Draw(SpriteBatch, GameTime)")," method in the Game1 class and change it to the following"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-csharp"}),"protected override void Draw(GameTime gameTime)\n{\n    //  If there is an active scene, draw it.\n    if(_activeScene != null)\n    {\n        _activeScene.BeforeDraw(_spriteBatch, Color.Black);\n        _activeScene.Draw(_spriteBatch);\n        _activeScene.AfterDraw(_spriteBatch);\n    }\n\n    base.Draw(gameTime);\n}\n")),Object(c.b)("p",null,"This will handle calling ",Object(c.b)("inlineCode",{parentName:"p"},"BeforeDraw(SpriteBatch, Color)"),", ",Object(c.b)("inlineCode",{parentName:"p"},"Draw(SpriteBatch)"),", and ",Object(c.b)("inlineCode",{parentName:"p"},"AfterDraw(SpriteBatch)"),", in that order, for the active scene."),Object(c.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(c.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(c.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"The default Game1 class clears the backbuffer using good old ",Object(c.b)("inlineCode",{parentName:"p"},"Color.CornflowerBlue")," by default. Here, I'm passing instead ",Object(c.b)("inlineCode",{parentName:"p"},"Color.Black")," as the color to clear the backbuffer with.  You can use whatever color you'd like."))),Object(c.b)("h3",{id:"changing-scenes"},"Changing Scenes"),Object(c.b)("p",null,"To change scenes, we're going to first create a method to handle setting what the next scene should be. "),Object(c.b)("p",null,"Add the following method to the Game1 class"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-csharp"}),'/// <summary>\n///     Sets the next scene to switch to.\n/// </summary>\n/// <param name="next">\n///     The Scene instance to switch to.\n/// </param>\npublic void ChangeScene(Scene next)\n{\n    //  Only set the _nextScene value if it is not the\n    //  same instance as the _activeScene.\n    if(_activeScene != next)\n    {\n        _nextScene = next;\n    }\n}\n')),Object(c.b)("p",null,"As far as things go, this is pretty simple.  It detects if the scene we are switching to is the same instance as the current active scene. Only if they are different instances will if set the value of ",Object(c.b)("inlineCode",{parentName:"p"},"_nextScene")),Object(c.b)("p",null,"Next we need to add an additional method to handle the actual transitioning from one scene to the next. Add the following method to the Game1 class."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-csharp"}),"/// <summary>\n///     Handles transitioning gracefully from one scene to\n///     the next.\n/// </summary>\nprivate void TransitionScene()\n{\n    if(_activeScene != null)\n    {\n        _activeScene.UnloadContent();\n    }\n\n    //  Perform a garbage collection to ensure memory is cleared\n    GC.Collect();\n\n    //  Set the active scene.\n    _activeScene = _nextScene;\n\n    //  Null the next scene value\n    _nextScene = null;\n\n    //  If the active scene isn't null, initialize it.\n    //  Remember, the Initialize method also calls the LoadContent method\n    if(_activeScene != null)\n    {\n        _activeScene.Initialize();\n    }\n}\n")),Object(c.b)("p",null,"A few things are happening here. First, if ",Object(c.b)("inlineCode",{parentName:"p"},"_activeScene")," isn't ",Object(c.b)("inlineCode",{parentName:"p"},"null"),", we tell it to unload all content managed by that scene by calling the ",Object(c.b)("inlineCode",{parentName:"p"},"Unload()")," method. We no longer need it, so free up the memory.  Next, we perform a manual garbage collection to ensure the memory is freed up.  Then we set the ",Object(c.b)("inlineCode",{parentName:"p"},"_activeScene")," to the ",Object(c.b)("inlineCode",{parentName:"p"},"_nextScene"),", and, if it isn't ",Object(c.b)("inlineCode",{parentName:"p"},"null"),", we call the ",Object(c.b)("inlineCode",{parentName:"p"},"Initialize")," method."),Object(c.b)("p",null,"Finally, we need to do one last change in the Game1 ",Object(c.b)("inlineCode",{parentName:"p"},"Update(GameTime)")," method.  Change it to the following."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-csharp"}),"protected override void Update(GameTime gameTime)\n{\n    //  If there is a next scene waiting to be switched to\n    //  transition to that scene.\n    if (_nextScene != null)\n    {\n        TransitionScene();\n    }\n\n    //  If there is an active scene, update it.\n    if (_activeScene != null)\n    {\n        _activeScene.Update(gameTime);\n    }\n\n    base.Update(gameTime);\n}\n")),Object(c.b)("p",null,'With this change, we detect first if there is a next scene to switch to, and if so, we perform the scene transitions. Now you may be asking, "why do we need to transition scene here?". Why didn\'t we just perform the transition inside the ',Object(c.b)("inlineCode",{parentName:"p"},"ChangeScene(Scene)")," method all at once. "),Object(c.b)("p",null,"Well, we could have, absolutely. However, remember when we end one scene, we unload all of the content managed by the scene. Also, most likely, the call to ",Object(c.b)("inlineCode",{parentName:"p"},"ChangeScene(Scene)")," will be performed from within a scene itself.  So by telling our game which scene to switch to, and then performing the actual transition during the next update frame, we can be sure no issues occur with any references to the current scene's properties, objects, etc."),Object(c.b)("p",null,"(actually, I'm probably talking out of my ass with that last paragraph, but this is generally the structure used.)"),Object(c.b)("p",null,"On the next page, we're going to test our setup."))}p.isMDXComponent=!0}}]);